{% extends 'shop/basic.html' %}
{% load static %}
{% block title %}GwCart - Shop what you want! {% endblock %}
{% block body %}
	<section id="slider"><!--slider-->
	<div class="container">
		<div class="row">
			<div class="col-sm-12">
				<div id="slider-carousel" class="carousel slide" data-ride="carousel">
					<ol class="carousel-indicators">
						<li data-target="#slider-carousel" data-slide-to="0" class="active"></li>
						<li data-target="#slider-carousel" data-slide-to="2"></li>
					</ol>
					<div class="carousel-inner">
						<div class="item active">
							<div class="col-sm-6">
								<h1><span>E</span>-SHOPPER</h1>
								<h2>Free E-Commerce Template</h2>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p>
								<button type="button" class="btn btn-default get">Get it now</button>
							</div>
							<div class="col-sm-6">
								<img src="{% static 'shop/images/home/girl1.jpg' %}" class="girl img-responsive" alt="" />
								<img src="{% static 'shop/images/home/pricing.png' %}"  class="pricing" alt="" />
							</div>
						</div>
						<div class="item">
							<div class="col-sm-6">
								<h1><span>E</span>-SHOPPER</h1>
								<h2>100% Responsive Design</h2>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p>
								<button type="button" class="btn btn-default get">Get it now</button>
							</div>
							<div class="col-sm-6">
								<img src="{% static 'shop/' %}images/home/girl2.jpg" class="girl img-responsive" alt="" />
								<img src="{% static 'shop/' %}images/home/pricing.png"  class="pricing" alt="" />
							</div>
						</div>
						<div class="item">
							<div class="col-sm-6">
								<h1><span>E</span>-SHOPPER</h1>
								<h2>Free Ecommerce Template</h2>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. </p>
								<button type="button" class="btn btn-default get">Get it now</button>
							</div>
							<div class="col-sm-6">
								<img src="{% static 'shop/' %}images/home/girl3.jpg" class="girl img-responsive" alt="" />
								<img src="{% static 'shop/' %}images/home/pricing.png" class="pricing" alt="" />
							</div>
						</div>
					</div>
					<a href="#slider-carousel" class="left control-carousel hidden-xs" data-slide="prev">
						<i class="fa fa-angle-left"></i>
					</a>
					<a href="#slider-carousel" class="right control-carousel hidden-xs" data-slide="next">
						<i class="fa fa-angle-right"></i>
					</a>
				</div>
			</div>
		</div>
	</div>
	</section><!--/slider-->
	<section>
		<div class="container">
			<div class="row">
				<div class="col-sm-3">
					<div class="left-sidebar">
						<h2>Category</h2>
						<div class="panel-group category-products" id="accordian"><!--category-productsr-->
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordian" href="#sportswear">
									<span class="badge pull-right"><i class="fa fa-plus"></i></span>
									Sportswear
								</a>
								</h4>
							</div>
							<div id="sportswear" class="panel-collapse collapse">
								<div class="panel-body">
									<ul>
										<li><a href="#">Nike </a></li>
										<li><a href="#">Under Armour </a></li>
										<li><a href="#">Adidas </a></li>
										<li><a href="#">Puma</a></li>
										<li><a href="#">ASICS </a></li>
									</ul>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordian" href="#mens">
									<span class="badge pull-right"><i class="fa fa-plus"></i></span>
									Mens
								</a>
								</h4>
							</div>
							<div id="mens" class="panel-collapse collapse">
								<div class="panel-body">
									<ul>
										<li><a href="#">Fendi</a></li>
										<li><a href="#">Guess</a></li>
										<li><a href="#">Valentino</a></li>
										<li><a href="#">Dior</a></li>
										<li><a href="#">Versace</a></li>
										<li><a href="#">Armani</a></li>
										<li><a href="#">Prada</a></li>
										<li><a href="#">Dolce and Gabbana</a></li>
										<li><a href="#">Chanel</a></li>
										<li><a href="#">Gucci</a></li>
									</ul>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordian" href="#womens">
									<span class="badge pull-right"><i class="fa fa-plus"></i></span>
									Womens
								</a>
								</h4>
							</div>
							<div id="womens" class="panel-collapse collapse">
								<div class="panel-body">
									<ul>
										<li><a href="#">Fendi</a></li>
										<li><a href="#">Guess</a></li>
										<li><a href="#">Valentino</a></li>
										<li><a href="#">Dior</a></li>
										<li><a href="#">Versace</a></li>
									</ul>
								</div>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Kids</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Fashion</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Households</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Interiors</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Clothing</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Bags</a></h4>
							</div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title"><a href="#">Shoes</a></h4>
							</div>
						</div>
						</div><!--/category-products-->
						<div class="brands_products"><!--brands_products-->
						<h2>Brands</h2>
						<div class="brands-name">
							<ul class="nav nav-pills nav-stacked">
								<li><a href="#"> <span class="pull-right">(50)</span>Acne</a></li>
								<li><a href="#"> <span class="pull-right">(56)</span>Grüne Erde</a></li>
								<li><a href="#"> <span class="pull-right">(27)</span>Albiro</a></li>
								<li><a href="#"> <span class="pull-right">(32)</span>Ronhill</a></li>
								<li><a href="#"> <span class="pull-right">(5)</span>Oddmolly</a></li>
								<li><a href="#"> <span class="pull-right">(9)</span>Boudestijn</a></li>
								<li><a href="#"> <span class="pull-right">(4)</span>Rösch creative culture</a></li>
							</ul>
						</div>
						</div><!--/brands_products-->
						<div class="price-range"><!--price-range-->
						<h2>Price Range</h2>
						<div class="well text-center">
							<input type="text" class="span2" value="" data-slider-min="0" data-slider-max="600" data-slider-step="5" data-slider-value="[250,450]" id="sl2" ><br />
							<b class="pull-left">$ 0</b> <b class="pull-right">$ 600</b>
						</div>
						</div><!--/price-range-->
						<div class="shipping text-center"><!--shipping-->
						<img src="{% static 'shop/images/home/shipping.jpg' %}" alt="" />
						</div><!--/shipping-->
					</div>
				</div>
				<div class="col-sm-9 padding-right">
					{% for product, range, nSlides in allProds %}
						<div class="features_items"><!--features_items-->
						<h2 class="title text-center">{{product.0.category}}</h2>
						{% for i in product %}
							<div class="col-sm-4">
								<div class="product-image-wrapper">
									<div class="single-products">
										<div class="productinfo text-center">
											<img src="/media/{{i.image}}" style="height: 234px; width: 255px;" alt="" />
											<h2 id="pricepr{{i.price}}">₹{{i.price}}</h2>
											<p id="namepr{{i.id}}">{{i.product_name}}</p>
											<p>{{i.desc|slice:'0:23'}}...</p>
											<span id="divpr{{i.id}}" class="divpr">
											<button id="pr{{i.id}}" class="btn btn-default cart"><i class="fa fa-shopping-cart"></i>Add To Cart</button></span>
											<a href="/products/{{i.id}}"><button id="qv{{i.id}}" class="btn btn-default cart"><i class="fa fa-search"></i>Quick View</button></a>
										</div>
										
									</div>
									<div class="choose">
										<ul class="nav nav-pills nav-justified">
											<li><a href="#"><i class="fa fa-plus-square"></i>Add to wishlist</a></li>
											<li><a href="#"><i class="fa fa-plus-square"></i>Add to compare</a></li>
										</ul>
									</div>
								</div>
							</div>
						{% endfor %}
						</div><!--features_items-->
					{% endfor %}
				</div>
			</div>
		</div>
	</section>
{% endblock %}
{% block js %}
	<script>
	// Find out the cart items from localStorage
	if (localStorage.getItem('cart') == null) {
	var cart = {};
	} else {
	cart = JSON.parse(localStorage.getItem('cart'));
	updateCart(cart);
	}
	// If the add to cart button is clicked, add/increment the item
	//$('.cart').click(function() {
	$('.divpr').on('click', 'button.cart', function(){
	var idstr = this.id.toString();
	if (cart[idstr] != undefined) {
	qty = cart[idstr][0] + 1;
	} else {
	qty = 1;
	name = document.getElementById('name'+idstr).innerHTML;
	
	cart[idstr] = [qty, name];
	}
	updateCart(cart);
	
	});
	//Add Popover to cart
	$('#popcart').popover();
	updatePopover(cart);
	function updatePopover(cart){
	console.log('we are inside updatePopover');
	var popStr = "";
	popStr = popStr + "<h5> Cart for your items in my GwCart </h5><div class='row'>";
		var i = 1;
		for (var item in cart){
			popStr = popStr +  "<b>" + i + "</b>. ";
			popStr = popStr + document.getElementById('name' + item).innerHTML + " Qty: " + cart[item][0] + '<br>';
			i = i+1;
		}
		popStr = popStr + "</div> <a href='/shop/checkout'><button class='btn btn-primary' id ='checkout'>Checkout</button></a> <button class='btn btn-primary' onclick='clearCart()' id ='clearCart'>Clear Cart</button>"
		document.getElementById('popcart').setAttribute('data-content', popStr);
		$('#popcart').popover('show');
		}
		function clearCart() {
		cart = JSON.parse(localStorage.getItem('cart'));
		for (var item in cart) {
		document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cart">Add To Cart</button>'
		}
		localStorage.clear();
		cart = {};
		updateCart(cart);
		}
		function updateCart(cart) {
			var sum = 0;
		for (var item in cart) {
				sum = sum + cart[item][0];
		document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
		}
		localStorage.setItem('cart', JSON.stringify(cart));
		document.getElementById('cart').innerHTML = sum;
			updatePopover(cart);
		
		}
		// If plus or minus button is clicked, change the cart as well as the display value
		$('.divpr').on("click", "button.minus", function() {
		a = this.id.slice(7, );
		cart['pr' + a][0] = cart['pr' + a] - 1;
		cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
		document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
		updateCart(cart);
		});
		$('.divpr').on("click", "button.plus", function() {
		a = this.id.slice(6, );
		cart['pr' + a][0] = cart['pr' + a][0] + 1;
		document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
		updateCart(cart);
		});
		</script>
	{% endblock %}